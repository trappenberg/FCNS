#Izhikevich model
import matplotlib.pyplot as plt

# Parameters and initialization
a=0.02; b=0.2; c=-65; d=2
Iext=10.; v=[-65]; u=[-65*b]; t=[0]; dt=0.5; 
        
for step in range(1,int(200/dt)):
    # record time steps 
    t.append(t[step-1]+dt)
    #numerical integration and recording of Izhikevich equations  
    v.append(v[step-1] + 
     dt*(0.04*v[step-1]**2+5*v[step-1]+140-u[step-1]+Iext)) 
    u.append(u[step-1]+dt*a*(b*v[step-1]-u[step-1]))
    if v[step]>30:
        v[step-1]=30; v[step]=c
        u[step]=u[step]+d
    
# Plotting results
plt.plot(t,v); plt.xlabel('t'); plt.ylabel('v');
